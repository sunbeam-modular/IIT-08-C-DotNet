
ASP.NET CORE IDENTITY 

--------------------------------------------------
1. INTRODUCTION TO ASP.NET CORE IDENTITY
--------------------------------------------------
ASP.NET Core Identity is a built-in authentication and authorization framework provided by Microsoft.
It is used to manage users, roles, passwords, login sessions, and security-related features in ASP.NET Core applications.

Identity is not just a login system; it is a complete user management framework that follows industry security standards.

--------------------------------------------------
2. WHY ASP.NET CORE IDENTITY IS REQUIRED
--------------------------------------------------
If developers build authentication manually, they must handle:
- User table design
- Secure password storage
- Hashing & salting logic
- Session handling
- Cookie security
- Role-based authorization
- Account lockout
- Password reset
- Email confirmation
- Protection from attacks

Manual implementation is risky and error-prone.

ASP.NET Core Identity provides:
- Pre-tested security
- Standardized implementation
- Faster development
- Enterprise-level reliability

--------------------------------------------------
3. PURPOSE OF ASP.NET CORE IDENTITY
--------------------------------------------------
The main purposes are:
- User registration and management
- Secure login and logout
- Role-based access control
- Claims-based authorization
- Password hashing and validation
- Token generation for security operations
- Integration with ASP.NET Core MVC, Razor Pages, and APIs

--------------------------------------------------
4. WHERE ASP.NET CORE IDENTITY IS USED
--------------------------------------------------
ASP.NET Core Identity is used in:
- College ERP systems (SPT – Student Performance Monitor)
- Banking and finance applications
- E-commerce platforms
- Admin dashboards
- Hospital management systems
- SaaS products
- Enterprise web portals
- REST APIs (with JWT integration)

--------------------------------------------------
5. CORE COMPONENTS OF ASP.NET CORE IDENTITY
--------------------------------------------------

5.1 IdentityUser
Represents a user account.
Default properties:
- Id
- UserName
- Email
- PasswordHash
- PhoneNumber
- LockoutEnabled
- AccessFailedCount

Custom user example:
ApplicationUser extends IdentityUser to add custom fields.

--------------------------------------------------
5.2 IdentityRole
Represents a role such as Admin, Staff, Student.
Used for role-based authorization.

--------------------------------------------------
5.3 UserManager<TUser>
Handles all user-related operations:
- Create user
- Update user
- Delete user
- Validate password
- Assign roles
- Lock or unlock users

--------------------------------------------------
5.4 RoleManager<TRole>
Handles role-related operations:
- Create roles
- Update roles
- Delete roles
- Assign claims to roles

--------------------------------------------------
5.5 SignInManager<TUser>
Responsible for:
- User login
- Logout
- Authentication cookie creation
- Two-factor authentication
- External logins

--------------------------------------------------
5.6 IdentityDbContext
Manages Identity-related database tables.
Works with Entity Framework Core.

--------------------------------------------------
6. ASP.NET CORE IDENTITY DATABASE TABLES
--------------------------------------------------
- AspNetUsers: Stores user information
- AspNetRoles: Stores role information
- AspNetUserRoles: Mapping between users and roles
- AspNetUserClaims: Claims assigned to users
- AspNetRoleClaims: Claims assigned to roles
- AspNetUserLogins: External login providers
- AspNetUserTokens: Tokens for reset and confirmation

--------------------------------------------------
7. INTERNAL WORKING OF ASP.NET CORE IDENTITY
--------------------------------------------------

7.1 Password Security
- Passwords are never stored in plain text
- Identity uses PBKDF2 hashing algorithm
- Salted and hashed passwords are stored
- Prevents rainbow table and brute-force attacks

--------------------------------------------------
7.2 Authentication Mechanism
- Uses cookie-based authentication by default
- Cookies are encrypted and signed
- Cookies are validated on every request

--------------------------------------------------
7.3 Security Features
- Account lockout after failed attempts
- Password complexity rules
- CSRF protection
- Token expiration
- Secure authentication cookies

--------------------------------------------------
8. LOGIN EXECUTION FLOW (STEP-BY-STEP)
--------------------------------------------------
1. User enters username and password
2. Controller sends request to SignInManager
3. UserManager fetches user from database
4. Password hash is verified
5. If valid, authentication cookie is generated
6. Cookie is sent to browser
7. Browser sends cookie on every request
8. User is authenticated

--------------------------------------------------
9. REGISTRATION EXECUTION FLOW
--------------------------------------------------
1. User submits registration form
2. UserManager.CreateAsync() is called
3. Password is hashed
4. User data is saved in AspNetUsers table
5. Role is assigned if required
6. Confirmation token may be generated

--------------------------------------------------
10. AUTHORIZATION FLOW (ROLE-BASED)
--------------------------------------------------
1. Request enters middleware pipeline
2. Authentication middleware validates cookie
3. Authorization middleware checks role
4. Controller action executes if authorized
5. Otherwise access is denied or redirected

--------------------------------------------------
11. MIDDLEWARE REQUEST PIPELINE WITH IDENTITY
--------------------------------------------------
Browser Request
↓
Authentication Middleware
↓
Authorization Middleware
↓
Controller
↓
Action Method

--------------------------------------------------
12. ROLE-BASED AUTHORIZATION EXAMPLE
--------------------------------------------------
Admin → Full access
Staff → Marks entry
Student → View results

Authorize attribute controls access.

--------------------------------------------------
13. ASP.NET CORE IDENTITY IN SPT PROJECT
--------------------------------------------------
SPT uses Identity to:
- Manage Admin, Staff, Student logins
- Restrict marks entry to Staff
- Restrict configuration to Admin
- Allow Students to view results securely

--------------------------------------------------
14. ASP.NET CORE IDENTITY VS CUSTOM AUTHENTICATION
--------------------------------------------------
Identity:
- Secure
- Scalable
- Industry standard
- Built-in features

Custom Authentication:
- Error-prone
- Security risks
- Time-consuming
- Not recommended

--------------------------------------------------
15. WHEN NOT TO USE ASP.NET CORE IDENTITY
--------------------------------------------------
- Static websites
- Applications without authentication
- Simple demo projects

--------------------------------------------------
16. Summary
--------------------------------------------------
ASP.NET Core Identity is a complete authentication and authorization framework that securely manages users, roles, passwords, and access control in ASP.NET Core applications. It provides industry-standard security features and is widely used in enterprise applications like SPT.

